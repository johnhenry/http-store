<html>
    <head>
        <title>HTTP Store</title>
    </head>
    <style>
        td, th {
            border: 1px solid black;
            text-align:center
            }
        table {
            border-collapse: collapse;
            }
    </style>
    <body>
        <a href="https://github.com/johnhenry/http-store" target="_blank">
            <img style="position: absolute; top: 0; right: 0; border: 0;"
            alt="Fork this on GitHub"
            src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png">
        </a>
        <h2>
            HTTP Store
        </h2>
        <h3>Now that your HTTP store server is running, you can connect to it with one of the zillions of applications that support HTTP or Web Sockets.</h3>
        <p>Here are just a few:</p>
        <table border="1">
            <tr>
                <th width="25%">
                    Application
                </th>
                <th>
                    Type
                </th>
                <th>
                    HTTP Interface
                </th>
                <th>
                    Web Sockets
                </th>
                <th>
                    Uploading Binary Files
                </th>
                <th>
                    Other Notes
                </th>
            </tr>
            <tr>
                <td>
                    <a href="#sample-app">
                        HTTP Store Sample Application
                    </a>
                    (Below)
                </td>
                <td>
                    Hosted Web Application
                </td>
                <td>
                    SUPPORTED
                </td>
                <td>
                    NOT SUPPORTED
                </td>
                <td>
                    NOT SUPPORTED
                </td>
                <td>
                    This app was made specifically to demo HTTP Store.
                </td>
            </tr>
            <tr>
                <td>
                    <a
                    href="http://curl.haxx.se/docs/"
                    target="_blank">
                    curl
                    </a>
                </td>
                <td>
                    Command Line Application
                </td>
                <td>
                    SUPPORTED
                </td>
                <td>
                    NOT SUPPORTED
                </td>
                <td>
                    SUPPORTED<br />
                </td>
                <td>
                    To upload binary files
                    Set the binary flag and<br />
                    And set Content-Type header with charset=binary<br />
                    As in this example:<br />
                    curl -X PUT <server address>/flowers/rose.jpg -H "Content-Type: image/jpeg; charset=binary" --data-binary @/full/path/to/http-store/example/rose.jpg
                </td>
            </tr>
            <tr>
                <td>
                    <a
                    href="http://www.gnu.org/software/wget/manual/wget.html" target="_blank">
                    wget
                    </a>
                </td>
                <td>
                    Command Line Application
                </td>
                <td>
                    SUPPORTED
                </td>
                <td>
                    NOT SUPPORTED
                </td>
                <td>
                    NOT TESTED
                </td>
                <td>

                </td>
            </tr>
            <tr>
                <td>
                    <a
                    href="https://www.npmjs.org/package/ws" target="_blank">
                    ws (wscat)
                    </a>
                </td>
                <td>
                    Command Line Application
                </td>
                <td>
                    NOT SUPPORTED
                </td>
                <td>
                    SUPPORTED
                </td>
                <td>
                    NOT TESTED
                </td>
                <td>

                </td>
            </tr>
            <tr>
                <td>
                    <a
                    href="http://restforchrome.blogspot.com/" target="_blank">
                    Advanced REST Client
                    </a>
                </td>
                <td>
                    Chrome Extension
                </td>
                <td>
                    SUPPORTED
                </td>
                <td>
                    SUPPORTED
                </td>
                <td>
                    NOT SUPPORTED
                </td>
                <td>

                </td>
            </tr>
            <tr>
                <td>
                    <a
                    href="http://www.getpostman.com/"
                    target="_blank">
                    Postman
                    </a>
                </td>
                <td>
                    Chrome Application & Chrome Extension
                </td>
                <td>
                    PARTIALLY SUPPORTED<br />
                    Does not support TRACE method
                </td>
                <td>
                    NOT SUPPORTED
                </td>
                <td>
                    NOT SUPPORTED
                </td>
                <td>

                </td>
            </tr>
            <tr>
                <td>
                    <a href="http://nodered.org/" target="_blank">Node-Red</a>
                </td>
                <td>
                    Hosted Web Application
                </td>
                <td>
                    PARTIALLY SUPPORTED<br />
                    Does not support HEAD, PATCH, TRACE
                </td>
                <td>
                    FURTHER TESTING NEEDED
                </td>
                <td>
                    FURTHER TESTING NEEDED
                </td>
                <td>
                    More functionality may be availablie beyond core componenets.
                </td>
            </tr>
            <tr>
                <td>
                    <a href="https://github.com/hakobera/Simple-WebSocket-Client" target="_blank">Simple WebSocket Client</a>
                </td>
                <td>
                    Chrome Extension
                </td>
                <td>
                    NOT SUPPORTED
                </td>
                <td>
                    PARTIALLY SUPPORTED<br />
                    Does not properly respond to empty messages.
                </td>
                <td>
                    NOT SUPPORTED
                </td>
                <td>

                </td>
            </tr>
            <tr>
                <td>
                    <a href="https://chrome.google.com/webstore/detail/dark-websocket-terminal/dmogdjmcpfaibncngoolgljgocdabhke" target="_blank">Dark Web Socket Terminal</a>
                </td>
                <td>
                    Chrome Application
                </td>
                <td>
                    NOT SUPPORTED
                </td>
                <td>
                    SUPPORTED
                </td>
                <td>
                    NOT SUPPORTED
                </td>
                <td>

                </td>
            </tr>
            <tr>
                <td>
                    <a href="https://www.sprintapi.com/dhcs.html" target="_blank">DHC - REST/HTTP API Client</a>
                </td>
                <td>
                    Web Application & Chrome Application
                </td>
                <td>
                    PARTIALLY SUPPORTED<br />
                    Does not support TRACE
                </td>
                <td>
                    SUPPORTED
                </td>
                <td>
                    NOT SUPPORTED
                </td>
                <td>

                </td>
            </tr>
        </table>
<hr />
        <h3><a name="sample-app">HTTP Store Sample Application</a></h3>
        <p>
            This sample application connects to this instance of HTTP store via the HTTP interface.
        </p>
        <h4>Request</h4>
        <form>
            <label>
                    Method :
                    <select id="method">
                        <option value="GET" selected>GET</option>
                        <option value="PUT">PUT</option>
                        <option value="DELETE">DELETE</option>
                        <option value="POST">POST</option>
                        <option value="HEAD">HEAD</option>
                        <option value="TRACE">TRACE</option>
                        <option value="PATCH">PATCH</option>
                    </select>
            </label>
            <p>
                <label>
                    Key : <input id="key">
                </label>
            </p>
            <p>
                <label>
                    Type :
                    <select id="type">
                        <option value="text/plain" selected>
                            text/plain</option>
                        <option value="text/html">
                            text/html</option>
                        <option value="application/json">
                            application/json</option>
                    </select>
                </label>
                <label>
                    Alt-Type : <input id="alt-type">
                </label>
            </p>
            <ul id="enqueue-box">
                <li>
                    <label>
                        <input id="enqueue" type=checkbox> Enqueue?
                    </label>
                </li>
            </ul>
            <ul id="dequeue-box">
                <li>
                    <label title="Remove item">
                        <input id="dequeue" type="checkbox"> Dequeue?
                    </label>
                </li>
                <li>
                    <label title="Start from end of list">
                        <input id="pop" type="checkbox"> Pop?
                    </label>
                </li>
                <li>
                    <label>
                        Index  <input id="index" type=number>
                    </label>
                </li>
            </ul>
            <div id="body-box">
                <label>
                    Body <br /><textarea id="body"></textarea>
                </label>
                <br />
                <label>
                    File: <input type="file" id="file"/>
                </label>
                <br />
                <br />
            </div>
            <label>
                <button id="submit" type="button">Send</button>
            </label>
        </form>
        <h4>Response <a id="response-url" target="_blank"></a></h4>
        <div>
        Status : <span id="response-status"></span>
        <br /><br />
        Type : <span id="response-type"></span>
        <br /><br />
        ID : <span id="response-id"></span>
        <br /><br />
        Response : <pre id="response-body"></pre>
        <div>
    <script ="encoding.js"></script>
        <script>
            var xmlhttp = new XMLHttpRequest();
            var responseURL = "";
            xmlhttp.onreadystatechange=function(){
            if (xmlhttp.readyState==4)
                {
                    document.getElementById("response-url")
                    .innerHTML = responseURL;
                    document.getElementById("response-url")
                    .href = responseURL;
                    document.getElementById("response-id")
                    .innerHTML=xmlhttp.getResponseHeader("ETag");
                    document.getElementById("response-type")
                    .innerHTML=xmlhttp.getResponseHeader("Content-type");
                    document.getElementById("response-status")
                    .innerHTML=xmlhttp.status;
                    document.getElementById("response-body")
                    .innerHTML=xmlhttp.responseText;
                    console.log(xmlhttp);
                }
            }
            var send = function(){
                document.getElementById("response-url")
                .innerHTML = "";
                document.getElementById("response-url")
                .href = "";
                var key = document.getElementById("key")
                    .value.split(" ").join(" ");
                var method =
                        document.getElementById("method").value;
                if(!key && method !== "PATCH")
                    return alert("Please set a key.");
                var type =
                    document.getElementById("alt-type").value
                        .split(" ").join(" ")
                    || document.getElementById("type").value;
                var body = document.getElementById("body").value;
                var queryHash = {
                    enqueue : document
                                .getElementById("enqueue")
                    .checked? "true" : "",
                    dequeue : document
                                .getElementById("dequeue")
                    .checked? "true" : "",
                    pop : document
                                .getElementById("pop")
                    .checked? "true" : "",
                    index : document
                            .getElementById("index")
                    .value ? document
                            .getElementById("index").value : ""
                }
                var query = [];
                for(k in queryHash){
                    if(queryHash[k]) query.push(k + "=" + queryHash[k]);
                }
                responseURL = key;
                if(query.length){
                    responseURL += "?" + query.join("&");
                }
                if(method === "PATCH") url = "/"
                xmlhttp.open(method, responseURL, false);
                xmlhttp.setRequestHeader("Content-type", type);
                xmlhttp.send(body);
            }
            var changeMethod = function(){
                var method = document.getElementById("method").value;
                switch(method){
                    case "PUT" :
                    case "POST" :
                        document
                            .getElementById("dequeue")
                            .checked = false
                        document
                            .getElementById("pop")
                            .checked = false;
                        document
                            .getElementById("index")
                            .checked = "";
                        document
                            .getElementById("body-box")
                            .style.display = "block";
                        document
                            .getElementById("enqueue-box")
                            .style.display = "block";
                        document
                            .getElementById("dequeue-box")
                            .style.display = "none";
                    break;
                    case "PATCH" :
                        document
                            .getElementById("dequeue")
                            .checked = false;
                        document
                            .getElementById("enqueue")
                            .checked = false;
                        document
                            .getElementById("pop")
                            .checked = false;
                        document
                            .getElementById("index")
                            .checked = "";
                        document
                            .getElementById("key")
                            .value = "";
                        document
                            .getElementById("body-box")
                            .style.display = "block";
                        document
                            .getElementById("enqueue-box")
                            .style.display = "none";
                        document
                            .getElementById("dequeue-box")
                            .style.display = "none";
                        document
                            .getElementById("type").value = "application/json"
                    break;
                    default :
                        document
                            .getElementById("enqueue")
                            .checked = false;
                        document
                            .getElementById("body-box")
                            .style.display = "none";
                        document
                            .getElementById("enqueue-box")
                            .style.display = "none";
                        document
                            .getElementById("dequeue-box")
                            .style.display = "block";
                }
            }
            var loadFile = function (evt) {
                var tgt = evt.target || window.event.srcElement,
                    files = tgt.files;
                // FileReader support
                if (FileReader && files && files.length) {
                    var fr = new FileReader();
                    fr.onload = function () {
                        var result = fr.result;
                        document.getElementById("body").value = result;
                    }
                    fr.readAsText(files[0]);
                }
            }
            document.getElementById('file')
            .addEventListener("change", loadFile);
            document.getElementById("submit")
            .addEventListener("click", send);
            document.getElementById("method")
            .addEventListener("change", changeMethod);
            changeMethod();
        </script>
    </body>
</html>
